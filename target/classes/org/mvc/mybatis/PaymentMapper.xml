<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="org.mvc.mybatis.PaymentMapper">
	
	<insert id="paymentInsert">
		insert into tbl_payment 
			(impUid, merchantUid, name, amount, 
			buyerName, buyerTel, buyerEmail, paidAt, status, c_id, c_num)
			values(#{impUid}, #{merchantUid}, #{name}, #{amount}, 
			#{buyerName}, #{buyerTel}, #{buyerEmail}, #{paidAt}, #{status}, #{c_id}, #{c_num})
	</insert>
	
	<select id="getPaymentList" resultType="org.mvc.bean.PaymentDTO">
		select * from tbl_payment order by paidat desc
	</select>
	
	<select id="getPaymentMyList" resultType="org.mvc.bean.PaymentDTO">
		select * from tbl_payment where buyerName = #{id} order by paidat desc 
	</select>
	
	<select id="getPaymentCoachList" resultType="org.mvc.bean.PaymentDTO">
		select * from tbl_payment where c_id = #{c_id} order by paidat desc 
	</select>
	
	<select id="getPaymentClassList" resultType="org.mvc.bean.PaymentDTO">
		select * from tbl_payment where c_num = #{c_num} order by paidat desc 
	</select>
	
	<select id="getOerderCount" resultType="int">
		select count(*) from tbl_payment
	</select>
	
	<select id="getMerchantUidInfo" resultType="org.mvc.bean.PaymentDTO">		
		select * from tbl_payment where merchantuid = #{merchant_uid}		
	</select>
	
	<update id="paymentCancelUpdate">
		update tbl_payment set
			status = #{status},
			cancelAmount = #{cancelAmount}
		where impUid = #{impUid}
	</update>
	
	<update id="paymentCancelInsert">
		insert into tbl_cancel
			values(seq_cancel.nextval, #{impUid}, #{cancelAmount}, #{cancelpAmount}, 
			#{cancelReason}, #{cancelledAt})
	</update>
	
	<select id="getCancelList" resultType="org.mvc.bean.PaymentDTO">
		select * from tbl_cancel where impuid = #{imp_Uid}
	</select>
</mapper>  